CL SCR
SET PAGESIZE 100
SET LINESIZE 120
SET FEEDBACK OFF
COLUMN LUUSERID HEADING 'USER ID OF USER'
COLUMN LUUSERNAME HEADING 'USER NAME' FORMAT A20
COLUMN XYZ NEW_VALUE NEW_DATE
SET TERMOUT OFF
SELECT TO_CHAR(SYSDATE,'DDTH MON,YYYY') AS XYZ FROM DUAL;
SET TERMOUT ON
REPF R "PAGE:"SQL.PNO            
TTITLE CE 'MAXIMUM FINES DETAILS' 
REPH CE 'National Institute of Science and Technology' SKIP 1 CE 'Palur Hills, Berhampur- 761008' SKIP 4 NEW_DATE SKIP 4


SELECT LUUSERID as "USER_ID",LUUSERNAME AS "NAME",SUM(LFFINEAMT) AS "SUM_FINE_AMT" FROM LIBUSERS JOIN LIBFINES USING (LUUSERID) GROUP BY LUUSERID,LUUSERNAME HAVING SUM(LFFINEAMT)=(SELECT MAX(SUM(LFFINEAMT)) FROM LIBFINES GROUP BY LUUSERID,LUUSERNAME);


REPF OFF
CLEAR BREAK
CLEAR COLUMN
TTITLE OFF
SET FEEDBACK ON
REPH OFF










